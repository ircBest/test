MPP (Manuscript Publication Program) 세부 요구사항 정의서


1. 프로젝트 개요
================================================================================

MPP는 Claude AI와 ChatGPT를 활용하여 블로그 원고를 자동으로 생성하고 치환하는 시스템입니다.
두 개의 AI를 순차적으로 사용하여 고품질의 다양한 원고를 생성합니다.


2. 핵심 기능 및 구현 이유
================================================================================

2-1. Claude API를 통한 원고 생성
----------------------------------------
구현 내용:
- ClaudeApiService.java에서 Claude API 호출
- 사용자가 입력한 프롬프트를 기반으로 원본 원고 생성
- 키워드와 주제를 받아 더욱 정확한 원고 생성 가능

구현 이유:
- Claude AI는 긴 문장 생성과 구조화된 콘텐츠 작성에 강점
- 블로그 원고처럼 체계적인 글을 작성하는데 적합
- max_tokens를 4096으로 설정하여 충분한 분량의 원고 생성 가능

작동 방식:
1. 사용자가 프롬프트 입력
2. 키워드와 주제가 있으면 작성 조건을 프롬프트에 자동 추가
   - 2500-3000자 분량
   - 목차 5개 구성
   - 20-30자 기준 줄바꿈
3. Claude API에 요청 전송
4. 응답받은 원고를 JSON 파싱하여 추출


2-2. ChatGPT API를 통한 원고 치환
----------------------------------------
구현 내용:
- ChatGptApiService.java에서 OpenAI API 호출
- Claude가 생성한 원고를 다른 표현으로 재작성
- 원본의 의미를 유지하면서 완전히 새로운 글로 변환

구현 이유:
- 같은 주제로 여러 버전의 원고 필요
- 표절 방지 및 콘텐츠 다양화
- GPT는 자연스러운 리라이팅에 강점

작동 방식:
1. Claude가 생성한 원본 원고를 입력받음
2. 시스템 메시지로 AI 역할 정의 (전문 콘텐츠 리라이터)
3. 재작성 조건 전달:
   - 2700자로 확장
   - 문장 구조 유지하되 표현 완전 변경
   - 키워드와 주제 자연스럽게 포함
   - 목차 5개 재구성
4. ChatGPT API에 요청 전송
5. 재작성된 원고 반환


2-3. 프롬프트 입력 UI
----------------------------------------
구현 내용:
- index.html에 textarea 형태의 입력창
- 여러 줄 입력 가능 (rows=5)
- placeholder로 사용 안내

구현 이유:
- 사용자가 원고 주제와 내용을 자유롭게 작성할 수 있어야 함
- 긴 텍스트 입력이 편리해야 함


2-4. 원고 수 설정
----------------------------------------
구현 내용:
- 1-10개 범위의 숫자 입력 필드
- 기본값 1개
- 최소/최대값 제한

구현 이유:
- 여러 버전의 원고를 한 번에 생성하는 요구사항
- 너무 많은 원고 생성 시 API 비용 및 시간 과다 소요 방지
- 10개 제한은 실용적인 범위


2-5. 작업 딜레이 설정
----------------------------------------
구현 내용:
- 기본값 10초
- 5-60초 범위 설정 가능
- BlogController.java에서 Thread.sleep()으로 구현

구현 이유:
- API 호출이 너무 빠르면 Rate Limit 오류 발생
- Claude와 ChatGPT 모두 연속 호출 제한 존재
- 10초는 안정적인 호출 간격
- 사용자가 상황에 맞게 조절 가능

작동 방식:
1. 첫 번째 원고 생성 완료
2. delaySeconds만큼 대기 (Thread.sleep)
3. 다음 원고 생성 시작


2-6. 자동/수동 저장 기능
----------------------------------------
구현 내용:
- 자동 저장: 체크박스로 활성화/비활성화
- 수동 저장: API 엔드포인트 제공 (현재 UI 미구현)
- FileStorageService.java에서 파일 저장 처리

구현 이유:
- 사용자가 선택적으로 저장 가능
- 테스트 시 불필요한 파일 생성 방지
- 자동 저장으로 편의성 제공

작동 방식:
1. autoSave 체크박스 확인
2. true면 각 원고 생성 후 자동으로 파일 저장
3. false면 화면에만 표시


2-7. 텍스트 파일 저장
----------------------------------------
구현 내용:
- generated-articles 폴더에 txt 파일로 저장
- 파일명: article_번호_날짜시간.txt
- 원본과 치환본을 하나의 파일에 구분하여 저장
- 절대 경로로 저장하여 위치 명확화

구현 이유:
- 간단하고 범용적인 텍스트 파일 형식
- 어떤 프로그램에서든 열람 가능
- 파일명에 타임스탬프 포함으로 중복 방지
- 절대 경로 표시로 파일 찾기 용이

파일 구조:
==================== 원본 원고 ====================
(Claude가 생성한 내용)

==================== 치환된 원고 ====================
(ChatGPT가 치환한 내용)


3. 기술적 구현 세부사항
================================================================================

3-1. Spring Boot 구조
----------------------------------------
- MppApplication.java: 메인 애플리케이션 클래스
- BlogController.java: REST API 엔드포인트 제공
- Service 계층: 비즈니스 로직 분리
- DTO: 요청/응답 데이터 구조화

이유:
- 계층화된 아키텍처로 유지보수 용이
- 각 클래스의 책임 명확히 분리
- Spring Boot의 DI 기능 활용


3-2. 비동기 처리 (Frontend)
----------------------------------------
- async/await를 사용한 비동기 API 호출
- 사용자 경험 향상 (UI 블로킹 방지)
- 진행 상황 실시간 표시


3-3. 클립보드 복사 기능
----------------------------------------
구현 내용:
- navigator.clipboard API 우선 사용
- 실패 시 execCommand fallback
- textarea를 이용한 구형 브라우저 호환

구현 이유:
- HTTP 환경에서 clipboard API 제한
- 모든 브라우저 환경 지원 필요
- 사용자가 원고를 쉽게 복사하여 사용

작동 방식:
1. clipboard API 지원 확인
2. 지원되면 writeText() 사용
3. 실패하거나 미지원 시:
   - 임시 textarea 생성
   - 텍스트 삽입 및 선택
   - execCommand('copy') 실행
   - textarea 제거


3-4. 에러 처리
----------------------------------------
- try-catch로 API 호출 실패 처리
- HTTP 상태 코드 확인
- 사용자에게 명확한 오류 메시지 표시


4. 데이터 흐름
================================================================================

전체 프로세스:
1. 사용자 입력 (프롬프트, 원고 수, 딜레이)
2. Frontend에서 /api/generate POST 요청
3. BlogController가 요청 수신
4. 반복 (원고 수만큼):
   a. ClaudeApiService로 원본 원고 생성
   b. ChatGptApiService로 원고 치환
   c. FileStorageService로 파일 저장 (자동저장 시)
   d. 응답 객체 생성
   e. 딜레이 적용
5. 모든 결과를 배열로 반환
6. Frontend에서 결과 화면에 표시


5. 설정 파일
================================================================================

5-1. application.properties
----------------------------------------
- API 키 설정
- API URL 및 모델 지정
- 파일 저장 경로 지정
- 로그 레벨 설정

이유:
- 설정과 코드 분리
- 환경별 설정 변경 용이


5-2. build.gradle
----------------------------------------
- 프로젝트 메타데이터
- 의존성 관리
- 빌드 설정

주요 의존성:
- spring-boot-starter-web: 웹 애플리케이션
- lombok: 코드 간소화
- jackson: JSON 처리
- httpclient5: HTTP 통신


6. 보안 및 주의사항
================================================================================

6-1. API 키 보안
----------------------------------------
- .gitignore에 설정 파일 제외
- 환경 변수 사용 권장
- 공개 저장소 업로드 금지


6-2. Rate Limiting
----------------------------------------
- 딜레이 설정으로 API 호출 제한 준수
- 최소 10초 권장


6-3. 비용 관리
----------------------------------------
- 원고 수 제한 (최대 10개)
- API 사용량 모니터링 필요


7. 확장 가능성
================================================================================

현재 구조의 장점:
- 키워드/주제 파라미터 추가 가능
- 다른 AI 모델로 쉽게 교체 가능
- Service 계층 분리로 기능 추가 용이
- DTO 패턴으로 API 스펙 확장 가능


향후 추가 가능 기능:
- 키워드/주제 입력 UI 추가
- 원고 템플릿 기능
- 저장 형식 선택 (txt, docx, pdf)
- 원고 이력 관리
- 배치 처리 기능
